{"version":3,"file":"fetch-future.es.js","sources":["../src/index.js"],"sourcesContent":["export const fetchF = Future => fn => function (input, options) {\n  return new Future((reject, resolve) => {\n    'use strict'\n    let request = new XMLHttpRequest()\n    let url = input;\n    request.open(options.method || 'get', url)\n\n    for (let i in options.headers) {\n      request.setRequestHeader(i, options.headers[i])\n    }\n\n    request.withCredentials = options.credentials === 'include'\n    request.onload = () => resolve(response())\n    request.onerror = reject\n    request.send(options.body)\n\n    function response () {\n      let keys = []\n      let all = []\n      let headers = {}\n      let header\n\n      request.getAllResponseHeaders().replace(/^(.*?):\\s*([\\s\\S]*?)$/gm, (m, key, value) => {\n        keys.push(key = key.toLowerCase())\n        all.push([key, value])\n        header = headers[key]\n        headers[key] = header ? `${header},${value}` : value\n      })\n      return {\n        ok: (request.status / 200 | 0) === 1,    // 200-399\n        status: request.status,\n        statusText: request.statusText,\n        url: request.responseURL,\n        clone: response,\n        text: () => Future.of(request.responseText),\n        json: () => Future.of(JSON.parse(request.responseText)),\n        xml: () => Future.of(request.responseXML),\n        blob: () => Future.of(new Blob([request.response])),\n        headers: {\n          keys: () => keys,\n          entries: () => all,\n          get: n => headers[n.toLowerCase()],\n          has: n => n.toLowerCase() in headers\n        }\n      }\n    }\n  })\n}\n"],"names":["const","let"],"mappings":"AAAOA,IAAM,MAAM,GAAG,UAAA,MAAM,EAAC,SAAG,UAAA,EAAE,EAAC,SAAG,UAAU,KAAK,EAAE,OAAO,EAAE;EAC9D,OAAO,IAAI,MAAM,CAAC,UAAC,MAAM,EAAE,OAAO,EAAE;IAClC,YAAY,CAAA;IACZC,IAAI,OAAO,GAAG,IAAI,cAAc,EAAE,CAAA;IAClCA,IAAI,GAAG,GAAG,KAAK,CAAC;IAChB,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,IAAI,KAAK,EAAE,GAAG,CAAC,CAAA;;IAE1C,KAAKA,IAAI,CAAC,IAAI,OAAO,CAAC,OAAO,EAAE;MAC7B,OAAO,CAAC,gBAAgB,CAAC,CAAC,EAAE,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAA;KAChD;;IAED,OAAO,CAAC,eAAe,GAAG,OAAO,CAAC,WAAW,KAAK,SAAS,CAAA;IAC3D,OAAO,CAAC,MAAM,GAAG,YAAG,SAAG,OAAO,CAAC,QAAQ,EAAE,CAAC,GAAA,CAAA;IAC1C,OAAO,CAAC,OAAO,GAAG,MAAM,CAAA;IACxB,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAA;;IAE1B,SAAS,QAAQ,IAAI;MACnBA,IAAI,IAAI,GAAG,EAAE,CAAA;MACbA,IAAI,GAAG,GAAG,EAAE,CAAA;MACZA,IAAI,OAAO,GAAG,EAAE,CAAA;MAChBA,IAAI,MAAM,CAAA;;MAEV,OAAO,CAAC,qBAAqB,EAAE,CAAC,OAAO,CAAC,yBAAyB,EAAE,UAAC,CAAC,EAAE,GAAG,EAAE,KAAK,EAAE;QACjF,IAAI,CAAC,IAAI,CAAC,GAAG,GAAG,GAAG,CAAC,WAAW,EAAE,CAAC,CAAA;QAClC,GAAG,CAAC,IAAI,CAAC,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC,CAAA;QACtB,MAAM,GAAG,OAAO,CAAC,GAAG,CAAC,CAAA;QACrB,OAAO,CAAC,GAAG,CAAC,GAAG,MAAM,IAAG,MAAS,MAAE,GAAE,KAAK,IAAK,KAAK,CAAA;OACrD,CAAC,CAAA;MACF,OAAO;QACL,EAAE,EAAE,CAAC,OAAO,CAAC,MAAM,GAAG,GAAG,GAAG,CAAC,MAAM,CAAC;QACpC,MAAM,EAAE,OAAO,CAAC,MAAM;QACtB,UAAU,EAAE,OAAO,CAAC,UAAU;QAC9B,GAAG,EAAE,OAAO,CAAC,WAAW;QACxB,KAAK,EAAE,QAAQ;QACf,IAAI,EAAE,YAAG,SAAG,MAAM,CAAC,EAAE,CAAC,OAAO,CAAC,YAAY,CAAC,GAAA;QAC3C,IAAI,EAAE,YAAG,SAAG,MAAM,CAAC,EAAE,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC,GAAA;QACvD,GAAG,EAAE,YAAG,SAAG,MAAM,CAAC,EAAE,CAAC,OAAO,CAAC,WAAW,CAAC,GAAA;QACzC,IAAI,EAAE,YAAG,SAAG,MAAM,CAAC,EAAE,CAAC,IAAI,IAAI,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,CAAC,GAAA;QACnD,OAAO,EAAE;UACP,IAAI,EAAE,YAAG,SAAG,IAAI,GAAA;UAChB,OAAO,EAAE,YAAG,SAAG,GAAG,GAAA;UAClB,GAAG,EAAE,UAAA,CAAC,EAAC,SAAG,OAAO,CAAC,CAAC,CAAC,WAAW,EAAE,CAAC,GAAA;UAClC,GAAG,EAAE,UAAA,CAAC,EAAC,SAAG,CAAC,CAAC,WAAW,EAAE,IAAI,OAAO,GAAA;SACrC;OACF;KACF;GACF,CAAC;CACH,MAAA,CAAA;;"}